p8105\_hw2\_smi2112
================

Problem 1
---------

Read and clean the data:

``` r
library(tidyverse)
```

    ## -- Attaching packages -------------------------------------------------------------------------------------------------------------------------- tidyverse 1.2.1 --

    ## v ggplot2 3.0.0     v purrr   0.2.5
    ## v tibble  1.4.2     v dplyr   0.7.6
    ## v tidyr   0.8.1     v stringr 1.3.1
    ## v readr   1.1.1     v forcats 0.3.0

    ## -- Conflicts ----------------------------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
transit_data = read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>%
  select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada) %>% 
  mutate(entry = if_else(entry == "YES", TRUE, FALSE))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_integer(),
    ##   Route9 = col_integer(),
    ##   Route10 = col_integer(),
    ##   Route11 = col_integer(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

Short paragraph:

... these data are not tidy yet ...........

Number of distinct stations: 465

``` r
transit_data %>% 
  select(line, station_name) %>% 
  n_distinct()
```

    ## [1] 465

Number of ADA compliant stations: 84

``` r
transit_data %>%
  select(line, station_name, ada) %>% 
  group_by(line, station_name) %>% 
  filter(ada == TRUE) %>% 
  n_distinct()
```

    ## [1] 84

Proportion of station entrances/exits without vending allowed entrace: 0.0980

``` r
38.7
```

    ## [1] 38.7

``` r
prop.table(table(transit_data$vending))*100
```

    ## 
    ##        NO       YES 
    ##  9.796574 90.203426

Reformat data:

``` r
transit_data_tidy = gather(transit_data, key = route_number, value = route_name, route1:route11) %>% 
  mutate(route_number = recode(route_number, 
                               "route1" = 1, 
                               "route2" = 2, 
                               "route3" = 3,
                               "route4" = 4, 
                               "route5" = 5, 
                               "route6" = 6, 
                               "route7" = 7, 
                               "route8" = 8, 
                               "route9" = 9, 
                               "route10" = 10, 
                               "route11" = 11)) 

is.numeric(transit_data_tidy$route_number)
```

    ## [1] TRUE

``` r
is.character(transit_data_tidy$route_name)
```

    ## [1] TRUE

Number of distinct stations serving the A train: 60

``` r
transit_data_tidy %>%
  select(line, station_name, route_name) %>% 
  filter(route_name == "A") %>% 
  n_distinct()
```

    ## [1] 60

Number of distinct stations serving the A train that are ADA compliant: 17

``` r
transit_data_tidy %>%
  select(line, station_name, route_name, ada) %>% 
  filter(route_name == "A" & ada == TRUE) %>% 
  n_distinct()
```

    ## [1] 17

Problem 2
---------

Reading and cleaning the Mr. Trash Wheel sheet:

``` r
library(readxl)

mr_trash = read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", "Mr. Trash Wheel", range = cell_cols("A:M")) %>%
  janitor::clean_names() %>% 
  filter(., !is.na(dumpster))

round(mr_trash$sports_balls) %>% 
  as.integer(mr_trash$sports_balls)
```

    ##   [1]  7  5  6  6  7  5  3  6  6  7  6  8  6  6  6  6  5  6  6  7  6  6  6
    ##  [24]  5  6  7  8  7  4  7  3  6  6  6  7  6  6  6  7  6  6  7  6  6  7  6
    ##  [47]  5  3  8 16 14 13 16  8  5  8 11  7  6  8 22 28 19 32 24 26 36 24  9
    ##  [70] 16 22 17 13 14 21 15 13 18 16 22 32 18 21 34 19 14 22 16 25 27 18 20
    ##  [93] 17 56 32 22  6  3 17 13 12  7  8 16 23 33 27 15 21  9 13 22 17 27  8
    ## [116] 17 14 21 26  6  4 16 24 23 18 46 38 24 36 42 23 34 38 26 32 43 38 24
    ## [139] 35 26 29 31 28 34 26 38 25 16 24 15 31 22 28 32 15 28 33 11 37 22 11
    ## [162] 34  6 24 20 15 22 19 12 14 18 10  6  8  8  5  3  5  7  2  7  3  4  5
    ## [185]  8 10  5  7  5  8 10 11 14 12  8  5  9  5 14 12  8  7 18 11 22 13 21
    ## [208] 14  9  6 13 11  6  8  5  6 12  8  7 13 11 12  8  6  4  6 12 14  5  4
    ## [231]  8  3  7 10 12  1  4  2  4  3  4  3  4  2  5  1  3  2  4  2  3  4  5
    ## [254]  3  2  3  0  2  3  2  1  2  5  4  3  2  4  2  8  3  2  2  3  1  5  3
    ## [277]  1  2  7  4  5  1  7  2  3

Reading and cleaning the precipitation data for 2016 and 2017:

``` r
precip_2016 = read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", "2016 Precipitation", range = cell_rows(2:14)) %>% 
  janitor::clean_names() %>% 
  mutate(year = 2016)

precip_2017 = read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", "2017 Precipitation", range = cell_rows(2:14)) %>% 
  janitor::clean_names() %>% 
  mutate(year = 2017)

month_info = tibble(
  month = 1:12, 
  month_name = month.name)

precip = union(precip_2016, precip_2017, by = "month") %>% 
  inner_join(., month_info, by = "month") %>% 
  select(-"month")
```

Paragraph about these data:

There are 285 observations in the Mr. Trash Wheel dataset. There are 24 observations in the precipitation dataset. Some key variables of interest are as follows:

Key variables:

There was 32.93 inches of precipitation in 2017. The median number of sports balls in a dumpster in 2016 was 26.

Problem 3
---------

Loading BRFSS data from p8105.datasets package:

``` r
devtools::install_github("p8105/p8105.datasets")
```

    ## Skipping install of 'p8105.datasets' from a github remote, the SHA1 (21f5ad1c) has not changed since last install.
    ##   Use `force = TRUE` to force installation

``` r
library(p8105.datasets)
data("brfss_smart2010")
```

Formatting the data:

``` r
brfss = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  rename(state = locationabbr, county = locationdesc) %>% 
  select(response, everything()) %>% 
  select(-class, -topic, -question, -sample_size, -c(confidence_limit_low:geo_location)) %>% 
  spread(key = response, value = data_value) %>% 
  janitor::clean_names() %>% 
  mutate(excellent_verygood = excellent + very_good)
```

There are 404 unique locations.

There are 51 states. Every state is represented, with Washington DC represented as well.

``` r
brfss %>% 
  select(state) %>% 
  group_by(state) %>% 
  count(state) %>% 
  arrange(desc(n))
```

    ## # A tibble: 51 x 2
    ## # Groups:   state [51]
    ##    state     n
    ##    <chr> <int>
    ##  1 NJ      146
    ##  2 FL      122
    ##  3 NC      115
    ##  4 WA       97
    ##  5 MD       90
    ##  6 MA       79
    ##  7 TX       71
    ##  8 NY       65
    ##  9 SC       63
    ## 10 CO       59
    ## # ... with 41 more rows

New Jersey has the most observations.

In 2002, the median of the "Excellent" response value was 23.6.

Histogram of "Excellent" response values in the year 2002:

``` r
brfss %>% 
  filter(year == 2002) %>% 
  ggplot(., aes(x = excellent)) + geom_histogram()
```

    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

    ## Warning: Removed 2 rows containing non-finite values (stat_bin).

![](p8105_hw2_smi2112_files/figure-markdown_github/unnamed-chunk-13-1.png)

Scatterplot of proportion of "Excellent" response values in New York County and Queens county in each year from 2002 to 2010:

``` r
brfss %>% 
  filter(county == "NY - New York County" | county == "NY - Queens County") %>% 
  ggplot(., aes(x = year, y = excellent, color = county)) + geom_point()
```

![](p8105_hw2_smi2112_files/figure-markdown_github/unnamed-chunk-14-1.png)
